[["index.html", "Global Fishing Watch Data Standard Operating Procedure Overview", " Global Fishing Watch Data Standard Operating Procedure 2020-12-02 Overview This reference guide describes standard operating procedures (SOP) for using Global Fishing Watch (GFW) data in emLab projects. This SOP is organized into 5 different sections: (1) Global Fishing Watch Basics, (2) Setup and Access, (3) Data, (4) Workflow, and (5) Additional Resources. Section 1 provides an overview of Global Fishing Watch data; Section 2 covers how to setup BigQuery and access the data; Section 3 describes the core GFW datasets and tables; Section 4 offers suggestions for streamlining workflow between BigQuery and R; and Section 5 highlights additional data training resources. "],["1-basics.html", "1 Global Fishing Watch Basics ", " 1 Global Fishing Watch Basics "],["1-1-types-of-data.html", "1.1 Types of Data", " 1.1 Types of Data The Global Fishing Watch (GFW) primary dataset is compiled from Automated Identification System (AIS) data. AIS was originally designed for ship-to-ship communication to help avoid collisions and vessels transmit a lot of information within an AIS message including vessel identity, position, and speed. AIS messages are received by other ships as well as being picked up by terrestrial and satellite receivers. These data are publicly available. More detailed information on AIS and the challenges and opportunities for using AIS to map and analyze fishing activity are presented in the 2019 Global Atlas of AIS-based Fishing Activity. The GFW database also has Vessel Monitoring System (VMS) data for a number of countries. VMS broadcasts vessel location to satellite and terrestrial receivers, which are then relayed to shore-based fishery monitoring centers. Unlike AIS, VMS data are not publicly available and the GFW database only contains data for countries who have agreed to share them. The BigQuery Reference Table contains the most up to date list of available country VMS data. GFW also has a new dark targets dataset composed of vessel detections derived from global satellite imagery collections including Visible Infrared Imaging Radiometer Suite (VIIRS) and Synthetic Aperture Radar (SAR). The VIIRS dataset uses satellites to detect vessels operating at night with visible light but is limited by clouds and lunar illumination. SAR uses radio waves to detect vessels but satellites are mainly land based and there is limited ocean coverage. These datasets have been used together and combined with high-resolution optical imagery to illuminate vessels that don’t broadcast AIS, also known as dark targets. Both of these datasets can detect vessels but neither show continuous vessel tracks. When possible, VIIRS detections are matched to AIS in the world-fishing-827.gfw_research.viirs_matched_vYYYYMMDD table. "],["1-2-available-data.html", "1.2 Available Data", " 1.2 Available Data The GFW AIS dataset includes three main types of information about vessels: attributes (such as length, tonnage, flag, and gear type), positions (in WGS84), and activities (like encounters, loitering, port visits, and fishing). Data are available from 2012 - present. Most of the tables with vessel information are related through the source specific vessel id (ssvid). For AIS data, the ssvid corresponds to the vessel’s Maritime Mobile Service Identity (MMSI). "],["1-3-data-caution.html", "1.3 Data Caution", " 1.3 Data Caution While GFW data are a powerful tool for analysis, there are a number of issues with AIS data which are important to consider. First, AIS has potential issues with reception quality, spoofing, and bad data. There are a number of situations where AIS messages might be broadcasted but not recorded by satellites. In order to receive a message, satellites must be overhead and terrestrial satellites will only record messages within line-of-sight (approximately 10 -100 nautical miles). AIS devices also vary in strength and high densities of vessels can interfere with each other preventing satellites from recording all vessel messages. There are two types of spoofing to be aware of: identity spoofing and location spoofing. Identity spoofing occurs when two or more vessels are simultaneously broadcasting the same vessel identification number, while location spoofing, or offsetting, refers to manipulation of the vessel’s AIS position to obscure the true location. Finally, bad data may show fishing vessel tracks in places that don’t make sense, like on land. There are a number of solutions to deal with these AIS problems. To verify reception quality, it may be helpful to check the quality of coverage for your research area using world-fishing-827.gfw_research.reception_quality_quarterdegree_vYYYYMMDD. Vessel info tables (such as world-fishing-827.gfw_research.vi_ssvid_byyear_vYYYYMMDD) can be filtered to exclude potential spoofing or offsetting vessels using the activity record. It is also common to filter for vessel segments with more than 10 positions that are not overlapping and short. Examples of common noise filters to deal with these types of issues can be found in the example queries on the GFW GitHub. The best way to deal with potentially bad data is to be diligent in checking, visualizing, and critically evaluating the data. GFW is constantly improving their pipeline process and vessel lists with help from research partners. Any bad data or possible data issues can be reported to the GFW team through the emlab-gfw slack channel. Posts should tag Tyler Clavelle on the GFW team. It is also important to consider how AIS has changed since it was first adopted, especially if using AIS data for time series studies. Both AIS reception quality and use of AIS have improved and grown in recent years. Time series studies should consider ways to deal with this, either by restricting analyses to only those vessels broadcasting at the beginning of the study time period or restricting analyses to 2016 onwards. While GFW data is accurate, it relies on the accuracy and transparency of public fisheries data. It is important to critically analyze the data before using them and to understand what can and can’t be said. For example best practice is to use terms like apparent fishing effort rather than fishing effort, and encounters and loitering events instead of transshipment events. Further, it’s important to recognize that AIS data only covers a fraction of the world’s fishing fleets. The Global Atlas of AIS-based Fishing Activity describes in more detail which fraction of the global fishing fleet is believed to be represented in the existing AIS data. "],["2-setup-and-access.html", "2 Setup and Access ", " 2 Setup and Access "],["2-1-bigquery-setup.html", "2.1 BigQuery Setup", " 2.1 BigQuery Setup BigQuery can be accessed in three ways: through the BigQuery console, the BigQuery command line interface, and through BigQuery APIs in Python or R. For more information on using BigQuery in R, refer to Section 4.1. BigQuery is part of the Google Cloud Platform (GCP). Details of getting your machine set up with GCP products is covered in the emLab SOP Section 5.1. Once gcloud is installed and your credentials are authenticated you should be able to set emlab-gcp as your project which will link you to emLab’s billing account. If you have any problems joining or connecting to emlab-gcp, please get in touch and we will help set you up. The BigQuery console provides a nice interface for writing and validating queries. The upper left corner of the BigQuery console displays the billing project code. For most emLab users, this should say emlab-gcp. The upper right corner shows the user, make sure you are logged in when running queries. Queries can be written in the query editor window and the validator will tell you how large the query is and will warn you if there are any syntax errors in the query. Once a query is run, the results will be displayed beneath the query editor window. Projects, datasets, and tables are displayed on the left hand side of the console. "],["2-2-billing.html", "2.2 Billing", " 2.2 Billing Queries cost $5/ TB. Best practice is always to use the validator in BigQuery to check the size of the query before running it. Any query over 100 GB should generally be considered large and caution should be taken when running them. Please see Section 4, Workflow, for more suggestions on best practices for streamlining workflow between BigQuery and R. "],["3-data.html", "3 Data", " 3 Data BigQuery data have a three level structure: projects, datasets, and tables. There are two main projects that you should have access to: world-fishing-827 and emlab-gcp. The GFW data lives in the world-fishing-827 project and core datasets and tables are discussed further below. The emlab-gcp project is where any scratch datasets and tables should be saved. Functions to create and save tables to BigQuery are detailed in Section 4.2.3. No direct changes should ever be made to GFW datasets or tables in the world-fishing-827 project. "],["3-1-core-ais-datasets-and-assumptions.html", "3.1 Core AIS Datasets and Assumptions", " 3.1 Core AIS Datasets and Assumptions The world-fishing-827 project has four main AIS datasets for general analysis: pipe_production_vYYYYMMDD, gfw_research, anchorages, and vessel_database. pipe_production_vYYYYMMDD This is GFW’s core internal dataset and is the output of the pipeline, which is a process that automates parsing, cleaning, augmenting, and publishing the raw AIS data. In most cases, queries should use the research tables in gfw_research not the pipeline tables. However, the following are some tables that are only found in the pipeline which may be useful to emLab researchers: port_events_YYYYMMDD List of port events by vessel id (not ssvid) Important fields: vessel_id, timestamp, anchorage_id Assumptions: Port events are individual events composed of a port entry/port exit pair. A port entry occurs when the vessel comes within 3 km of an anchorage point and the port exit occurs when the vessel is more than 4 km from an anchorage point The port events table is organized daily. To select all events from a year (for example 2020) use world-fishing-827.pipe_production_vYYYYMMDD.port_events_2020*, or select a single day (for example 1.1.20) to reduce query size and cost using world-fishing-827.pipe_production_vYYYYMMDD.port_events_20200101 port_visits_YYYYMMDD List of port visits by vessel id (not ssvid) Important fields: vessel_id, start_anchorage_id, end_anchorage_id, start_timestamp, end_timestamp Assumptions: port visits must include a port entry, a port stop or a port gap, and a port exit. Port stops begin when the vessel speed is &lt; 0.2 knots and ends when the vessel speed is &gt; 0.5 knots. Port gaps are defined as gaps in AIS transmission for more than 4 hours The port visits table is also organized daily and can be subsetted and queried in the same way as the port events table published_events_encounters List of encounter events; each encounter event is listed twice with the event_id field ending in .1 or .2 to distinguish between the first and second vessel involved Important fields: event_id, vessel_id, event_start, event_end Assumptions: 2 vessels within 500 meters of each other, traveling &lt; 2 knots, minimum duration of 2 hours, and at least 10 km from a coastal anchorage spatial_measures_YYYYMMDD Spatial information (for EEZs, RMFOs etc.) by gridded longitude, latitude Important fields: gridcode, regions record Assumptions: Gridded longitude, latitude (WGS84) at 0.01 resolution voyages List of voyages by ssvid Important fields: ssvid, vessel_id, trip_id, trip_start_anchorage_id, trip_end_anchorage_id Assumptions: voyages are a port exit/port entry pair, following a vessel from when it leaves a port to the next time it enters a port gfw_research The second dataset gfw_research, is most commonly used by GFW research partners. These tables are versions of the pipeline tables that have been altered to make them more suitable and cost effective for analysis. The following are some tables that may be most relevant to emLab researchers: eez_info List of Exclusive Economic Zones (EEZ), can be used to add country names or ISO3 codes to the numeric EEZ id Important fields: eez_id, territory1, territory1_iso3, sovereign1, sovereign1_iso3 fishing_vessels_ssvid_vYYYYMMDD Current best list of active fishing vessels by ssvid by year Important fields: ssvid, year, best_flag best_vessel_class (gear type) Assumptions: MMSI is on_fishing_list_best, MMSI is not likely fishing gear based on shipname, MMSI is not offsetting its position, MMI did not broadcast 5 or more different shipnames in a year, MMSI is spoofed no more than 24 hours in a year, the MMSI was active enough for the nerual net to infer a vessel class, and the MMSI is active for at least 5 days and has at least 24 hours of fishing activity in a year loitering_events_2knots_vYYYYMMDD List of loitering activities by vessel. Queries will likely want to further restrict results to vessels of a specific type, a minimum distance from shore, and a minimum event duration Important fields: ssvid, loitering_start_timestamp, loitering_end_timestamp, loitering_hours, avg_distance_from_shore_nm, start_lon, start_lat, end_lon, end_lat Assumptions: vessels are moving at &lt; 2 knots (includes all vessel types) pipe_vYYYYMMDD_fishing Table of fishing activity, best table to use to find active fishing positions Important fields: seg_id, ssvid, timestamp, lat, lon, nnet_score2, regions records Assumptions: Vessels are listed on at least one of the fishing lists in the vi_ssvid_byyyear_vYYYYMMDD table This is a partitioned table. See Section 4.2.4 for more infomraiton about subsetting data in partitioned tables pipe_vYYYYMMDD_segs Used to identify good segements for inclusion in analyses Important fields: good_seg, positions, overlapping_and_short Assumptions: To be labeled as a good_seg, there are more than 5 positions, the vessel moves at least ~100 meters with an average speed &gt; 0, and the longitude is not between -0.109225 and 0.109225 vi_ssvid_byyear_vYYYYMMDD Summary of annual vessel activity and identity information by ssvid. This table is best used to summarize vessel activity (like fishing hours) by ssvid if specific position data (lat/lon) are not important. Queries should use good segments and the neural net score from the pipe_vYYYYMMDD_fishing table if position data are important Important fields: ssvid, year, activity records (summary of the amount and location of the vessel’s activity), best records (best vessel characteristics) anchorages The GFW data uses anchorages which are different from ports. The anchorage datset gridded the globe at approximately 0.5 km cells and identified grid cells where at least 20 individual vessels remained stationary from 2012-2019. Each location was assigned a unique anchorage id. Generally, there are many anchorages within a single port. More information about how anchorages are assigned can be found on the GFW website. The following table is likely the most useful for emLab researchers: named_anchorages_vYYYYMMDD List of all named anchorages in the GFW data Important fields: s2id (anchorage id), iso3, lat, lon Assumptions: at least 20 vessels remained stationary between 2012 and 2019 vessel_database The vessel database is a collection of tables tracking vessel registry information. This database is particularly useful for querying lists of non-fishing vessels, such as carriers. For lists of fishing vessels, it’s better to use gfw_research.fishing_vessels_ssvid_vYYYYMMDD. The following table may be the most useful to emLab researchers: all_vessels_vYYYYMMDD List of all vessels in the GFW database for all years Important fields: identity records, feature records, is_carieer, registry records (especially registry.confidence) The vesssel database is not comprehensive adn is only as good as the AIS and registry data. The dataset may contain typos or outdated records and caution should be used in analysis. "],["3-2-best-tables.html", "3.2 Best Tables", " 3.2 Best Tables The GFW Data Training shared Drive contains the ‘BigQuery Table Reference’ sheet whch is the best place to find which table versions are the most up to date. Sometimes the newest versions of tables are in-development so it is not safe to assume that the latest version by date is the best version to use. This directory is maintained by GFW and is the best place to check for information about which tables to use. Any tables in the gfw_research dataset beginning with pipe_vYYYYMMDD_ are tables that result directly from the pipeline. The best version of these tables to use will correspond to the current best pipeline dataset in the ‘BigQuery Table Reference’ sheet. For example, if the current best pipeline is pipe_production_v20190502 then the best versions of the tables to use in the gfw_research dataset will be pipe_v20190502_. If you can’t access the shared drive, please reach out to Tyler Clavelle at GFW. "],["3-3-vms-datasets.html", "3.3 VMS Datasets", " 3.3 VMS Datasets Country VMS datasets provide reliable vessel tracking with low risks of tampering or transmission gaps since VMS devices generally broadcast at fixed rates and many countries impose strict requirements on VMS use with hefty fines for violations. When available, VMS data can complement AIS data, particularly in regions where AIS reception is poor, allowing for a greater understanding of fishing activity. The VMS datasets do not have equivalent research tables like the AIS pipeline does. As a result, the VMS datasets do not have an ‘hours’ field from which to calculate fishing hours. Instead, fishing hours can be calculated using the absolute value of the difference between two timestamps. An example of querying fishing hours from a VMS dataset is provided on the GFW GitHub. "],["3-4-dark-targets-tables.html", "3.4 Dark Targets Tables", " 3.4 Dark Targets Tables The dark targets tables identify vessels that are not broadcasting AIS and includes two main tables in the gfw_research dataset: sar_ds3_fmean250_e10_d70_s20_8xmean_ns Main table for SAR detections Important fields: ssvid, lat, lon, detection_time Assumptions: Detections are based on a random forest model trained on distance from shore, distance from port, bathymetry, slope, and the density of fishing vessels This is a partitioned table. See Section 4.2.4 for more information about subsetting data in partitioned tables viirs_matched_vYYYYMMDD Table of VIIRS detections matched with AIS data Important fields: detection_id, detect_lat, detect_lon, detect_timestamp, QF_detect (quality flag field), ssvid This is a partitioned table. See Section 4.2.4 for more information about subsetting data in partitioned tables "],["4-workflow.html", "4 Workflow", " 4 Workflow "],["5-additional-resources.html", "5 Additional Resources", " 5 Additional Resources "]]
